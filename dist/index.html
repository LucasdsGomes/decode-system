<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Decode Now - Your password is our happiness</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
            <div class="container">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars ms-1"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
                        <li class="nav-item"><a class="nav-link" href="#services">Decode Options</a></li>
                        <li class="nav-item"><a class="nav-link" href="#portfolio">Portfolio</a></li>
                        <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
                        <li class="nav-item"><a class="nav-link" href="#team">Team</a></li>
                        <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Masthead-->
        <header class="masthead">
            <div class="container">
                <div class="masthead-subheading">Welcome To Our Decoding!</div>
                <div class="masthead-heading text-uppercase">It's Nice To Meet You</div>
                <a class="btn btn-primary btn-xl text-uppercase" href="#services">Tell Me More</a>
            </div>
        </header>
        <!-- Services-->
        <section class="page-section" id="services">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Our decoding options</h2>
                    <h3 class="section-subheading text-muted">Here you will find all the decodings that the world offers us.</h3>
                </div>
                <div class="row">
                    <!-- Caesar Cipher -->
                    <div class="container mb-5">
                        <h4 class="my-3">Cifra de César - Caesar Cipher</h4>
                        <p class="text-muted">An encryption technique that replaces each letter of a message with another letter a fixed number of positions down the alphabet.</p>
                        <div class="form-floating mb-3 w-50">
                            <input type="text" class="form-control" id="caesarMessage" placeholder="Message">
                            <label>Message</label>
                        </div>
                        <div class="form-floating w-50 mb-3">
                            <div class="form-floating mb-3 w-50 mt-3">
                                <input type="number" class="form-control" id="caesarShift" placeholder="Shift">
                                <label for="caesarShift">Shift (deslocamento)</label>
                            </div>
                            
                            <div class="mt-2">
                                <button type="button" class="btn btn-outline-success" id="caesarEncode">Code</button>
                                <button type="button" class="btn btn-outline-danger" id="caesarDecode">Decode</button>
                            </div>
                        </div>
                        <div class="mb-3 w-50">
                            <label class="form-label">Result</label>
                            <textarea class="form-control" id="caesarResult" rows="3" disabled></textarea>
                        </div>
                    </div>

                    <hr>
                    
                    <!-- Vigenère Cipher -->
                    <div class="container mb-5">
                        <h4 class="my-3">Cifra de Vigenère - Vigenère Cipher</h4>
                        <p class="text-muted">A method of encrypting alphabetic text by using a series of interwoven Caesar ciphers, based on the letters of a keyword.</p>
                        <div class="form-floating mb-3 w-50">
                            <input type="text" class="form-control" id="vigenereMessage" placeholder="Message">
                            <label>Message</label>
                        </div>
                        <div class="form-floating w-50 mb-3">
                            <input type="text" class="form-control" id="vigenereKeyword" placeholder="Keyword">
                            <label for="vigenereKeyword">Keyword</label>
                            
                            <div class="mt-3">
                                <button type="button" class="btn btn-outline-success" id="vigenereEncode">Code</button>
                                <button type="button" class="btn btn-outline-danger" id="vigenereDecode">Decode</button>
                            </div>
                        </div>
                        <div class="mb-3 w-50">
                            <label class="form-label">Result</label>
                            <textarea class="form-control" id="vigenereResult" rows="3" disabled></textarea>
                        </div>
                    </div>

                    <hr>

                    <!-- Columnar Transposition Cipher -->
                    <div class="container mb-5">
                        <h4 class="my-3">Cifra de Transposição Colunar - Columnar Transposition Cipher</h4>
                        <p class="text-muted">A cipher that rearranges the plaintext by writing it in rows under a keyword and then reading the columns in alphabetical order of the keyword letters.</p>
                        <div class="form-floating mb-3 w-50">
                            <input type="text" class="form-control" id="columnarMessage" placeholder="Message">
                            <label>Message</label>
                        </div>
                        <div class="form-floating w-50 mb-3">
                            <input type="text" class="form-control" id="columnarKeyword" placeholder="Keyword">
                            <label for="columnarKeyword">Keyword</label>
                            
                            <div class="mt-3">
                                <button type="button" class="btn btn-outline-success" id="columnarEncode">Code</button>
                                <button type="button" class="btn btn-outline-danger" id="columnarDecode">Decode</button>
                            </div>
                        </div>
                        <div class="mb-3 w-50">
                            <label class="form-label">Result</label>
                            <textarea class="form-control" id="columnarResult" rows="3" disabled></textarea>
                        </div>
                    </div>

                    <hr>

                    <!-- RSA Cipher -->
                    <div class="container mb-5">
                        <h4 class="my-3">Criptografia RSA</h4>
                        <p class="text-muted">Algoritmo de criptografia assimétrica amplamente utilizado para segurança de dados.</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="rsaP" placeholder="Número primo p" value="11">
                                    <label for="rsaP">Número primo p</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="rsaQ" placeholder="Número primo q" value="17">
                                    <label for="rsaQ">Número primo q</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="rsaE" placeholder="Chave pública e" value="23">
                                    <label for="rsaE">Chave pública e</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="rsaD" placeholder="Chave privada d" value="7">
                                    <label for="rsaD">Chave privada d</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-floating mb-3 w-100">
                            <input type="text" class="form-control" id="rsaMessage" placeholder="Message">
                            <label>Message</label>
                        </div>
                        
                        <div class="mt-3">
                            <button type="button" class="btn btn-outline-success" id="rsaEncode">Criptografar</button>
                            <button type="button" class="btn btn-outline-danger" id="rsaDecode">Descriptografar</button>
                        </div>
                        
                        <div class="mb-3 w-100 mt-3">
                            <label class="form-label">Resultado</label>
                            <textarea class="form-control" id="rsaResult" rows="3" disabled></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    
        <!-- Contact-->
        <section class="page-section" id="contact">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Contact Us</h2>
                    <h3 class="section-subheading text-muted">Lorem ipsum dolor sit amet consectetur.</h3>
                </div>
                <form id="contactForm" data-sb-form-api-token="API_TOKEN">
                    <div class="row align-items-stretch mb-5">
                        <div class="col-md-6">
                            <div class="form-group">
                                <!-- Name input-->
                                <input class="form-control" id="name" type="text" placeholder="Your Name *" data-sb-validations="required" />
                                <div class="invalid-feedback" data-sb-feedback="name:required">A name is required.</div>
                            </div>
                            <div class="form-group">
                                <!-- Email address input-->
                                <input class="form-control" id="email" type="email" placeholder="Your Email *" data-sb-validations="required,email" />
                                <div class="invalid-feedback" data-sb-feedback="email:required">An email is required.</div>
                                <div class="invalid-feedback" data-sb-feedback="email:email">Email is not valid.</div>
                            </div>
                            <div class="form-group mb-md-0">
                                <!-- Phone number input-->
                                <input class="form-control" id="phone" type="tel" placeholder="Your Phone *" data-sb-validations="required" />
                                <div class="invalid-feedback" data-sb-feedback="phone:required">A phone number is required.</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group form-group-textarea mb-md-0">
                                <!-- Message input-->
                                <textarea class="form-control" id="message" placeholder="Your Message *" data-sb-validations="required"></textarea>
                                <div class="invalid-feedback" data-sb-feedback="message:required">A message is required.</div>
                            </div>
                        </div>
                    </div>
                    <!-- Submit success message-->
                    <div class="d-none" id="submitSuccessMessage">
                        <div class="text-center text-white mb-3">
                            <div class="fw-bolder">Form submission successful!</div>
                            To activate this form, sign up at
                            <br />
                            <a href="https://startbootstrap.com/solution/contact-forms">https://startbootstrap.com/solution/contact-forms</a>
                        </div>
                    </div>
                    <!-- Submit error message-->
                    <div class="d-none" id="submitErrorMessage"><div class="text-center text-danger mb-3">Error sending message!</div></div>
                    <!-- Submit Button-->
                    <div class="text-center"><button class="btn btn-primary btn-xl text-uppercase disabled" id="submitButton" type="submit">Send Message</button></div>
                </form>
            </div>
        </section>
        <!-- Footer-->
        <footer class="footer py-4">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-4 text-lg-start">Copyright &copy; Decode Now 2025</div>
                    <div class="col-lg-4 my-3 my-lg-0">
                        <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                    <div class="col-lg-4 text-lg-end">
                        <a class="link-dark text-decoration-none me-3" href="#!">Privacy Policy</a>
                        <a class="link-dark text-decoration-none" href="#!">Terms of Use</a>
                    </div>
                </div>
            </div>
        </footer>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

        <script>
            // Caesar Cipher Implementation
            document.getElementById('caesarEncode').addEventListener('click', function() {
                const message = document.getElementById('caesarMessage').value;
                const shift = parseInt(document.getElementById('caesarShift').value);
                document.getElementById('caesarResult').value = caesarCipher(message, shift);
            });

            document.getElementById('caesarDecode').addEventListener('click', function() {
                const message = document.getElementById('caesarMessage').value;
                const shift = parseInt(document.getElementById('caesarShift').value);
                document.getElementById('caesarResult').value = caesarCipher(message, -shift);
            });

            function caesarCipher(str, shift) {
                shift = shift % 26;
                if (shift < 0) shift += 26;

                return str.split('').map(char => {
                    if (/[a-zA-Z]/.test(char)) {
                        const code = char.charCodeAt(0);
                        if (code >= 65 && code <= 90) {
                            return String.fromCharCode(((code - 65 + shift) % 26) + 65);
                        }
                        else if (code >= 97 && code <= 122) {
                            return String.fromCharCode(((code - 97 + shift) % 26) + 97);
                        }
                    }
                    return char;
                }).join('');
            }

            // Vigenère Cipher Implementation
            document.getElementById('vigenereEncode').addEventListener('click', function() {
                const message = document.getElementById('vigenereMessage').value;
                const keyword = document.getElementById('vigenereKeyword').value;
                document.getElementById('vigenereResult').value = vigenereCipher(message, keyword, true);
            });

            document.getElementById('vigenereDecode').addEventListener('click', function() {
                const message = document.getElementById('vigenereMessage').value;
                const keyword = document.getElementById('vigenereKeyword').value;
                document.getElementById('vigenereResult').value = vigenereCipher(message, keyword, false);
            });

            function vigenereCipher(text, key, encode) {
                if (!key || !key.length) return "Please enter a keyword";
                if (!/^[A-Za-z]+$/.test(key)) return "Keyword should only contain letters";
                
                const result = [];
                let keyIndex = 0;
                const uppercaseKey = key.toUpperCase();
                
                for (let i = 0; i < text.length; i++) {
                    const char = text[i];
                    
                    if (/[A-Za-z]/.test(char)) {
                        const isUpperCase = char === char.toUpperCase();
                        const base = isUpperCase ? 65 : 97;
                        const charValue = char.toUpperCase().charCodeAt(0) - 65;
                        const keyChar = uppercaseKey[keyIndex % uppercaseKey.length];
                        const keyValue = keyChar.charCodeAt(0) - 65;
                        
                        let resultValue;
                        if (encode) {
                            resultValue = (charValue + keyValue) % 26;
                        } else {
                            resultValue = (charValue - keyValue + 26) % 26;
                        }
                        
                        const resultChar = String.fromCharCode(resultValue + base);
                        result.push(isUpperCase ? resultChar : resultChar.toLowerCase());
                        keyIndex++;
                    } else {
                        result.push(char);
                    }
                }
                
                return result.join('');
            }

            // Columnar Transposition Cipher Implementation
            document.getElementById('columnarEncode').addEventListener('click', function() {
                const message = document.getElementById('columnarMessage').value;
                const keyword = document.getElementById('columnarKeyword').value;
                document.getElementById('columnarResult').value = columnarTranspositionCipher(message, keyword, true);
            });

            document.getElementById('columnarDecode').addEventListener('click', function() {
                const message = document.getElementById('columnarMessage').value;
                const keyword = document.getElementById('columnarKeyword').value;
                document.getElementById('columnarResult').value = columnarTranspositionCipher(message, keyword, false);
            });

            function columnarTranspositionCipher(text, key, encode) {
                if (!key || !key.length) return "Please enter a keyword";
                const cleanKey = key.replace(/[^A-Za-z]/g, '').toUpperCase();
                if (!cleanKey.length) return "Keyword must contain at least one letter";

                const keyChars = cleanKey.split('').map((char, index) => ({
                    char,
                    index
                }));

                const sortedKeyChars = [...keyChars].sort((a, b) => {
                    if (a.char === b.char) return a.index - b.index;
                    return a.char.localeCompare(b.char);
                });

                const keyLength = cleanKey.length;
                const textLength = text.length;

                if (encode) {
                    const rows = Math.ceil(textLength / keyLength);
                    const grid = [];

                    for (let i = 0; i < rows; i++) {
                        const start = i * keyLength;
                        const row = text.slice(start, start + keyLength).split('');
                        while (row.length < keyLength) row.push('X');
                        grid.push(row);
                    }

                    let ciphertext = '';
                    for (let { index: col } of sortedKeyChars) {
                        for (let row = 0; row < rows; row++) {
                            ciphertext += grid[row][col];
                        }
                    }

                    return ciphertext;
                } else {
                    const rows = Math.ceil(textLength / keyLength);
                    const cols = keyLength;
                    const totalChars = rows * cols;

                    const grid = Array.from({ length: rows }, () => Array(cols).fill(''));

                    const numFullCols = textLength % keyLength;
                    const colHeights = Array(keyLength).fill(Math.floor(textLength / keyLength));

                    for (let i = 0; i < numFullCols; i++) {
                        colHeights[sortedKeyChars[i].index]++;
                    }

                    let pos = 0;
                    for (let { index: col } of sortedKeyChars) {
                        const height = colHeights[col];
                        for (let row = 0; row < height; row++) {
                            grid[row][col] = text[pos++];
                        }
                    }

                    let plaintext = '';
                    for (let row = 0; row < rows; row++) {
                        for (let col = 0; col < cols; col++) {
                            plaintext += grid[row][col];
                        }
                    }

                    return plaintext;
                }
            }

            // RSA Cipher Implementation
            document.getElementById('rsaEncode').addEventListener('click', function() {
                const message = document.getElementById('rsaMessage').value;
                const p = parseInt(document.getElementById('rsaP').value);
                const q = parseInt(document.getElementById('rsaQ').value);
                const e = parseInt(document.getElementById('rsaE').value);
                
                if (!isPrime(p) || !isPrime(q)) {
                    document.getElementById('rsaResult').value = "p e q devem ser números primos!";
                    return;
                }
                
                const n = p * q;
                const phi = (p - 1) * (q - 1);
                
                if (gcd(e, phi) !== 1) {
                    document.getElementById('rsaResult').value = "e deve ser coprimo com φ(n) = " + phi;
                    return;
                }
                
                const encrypted = rsaEncrypt(message, e, n);
                document.getElementById('rsaResult').value = encrypted.join(' ');
            });

            document.getElementById('rsaDecode').addEventListener('click', function() {
                const encryptedText = document.getElementById('rsaMessage').value;
                const p = parseInt(document.getElementById('rsaP').value);
                const q = parseInt(document.getElementById('rsaQ').value);
                const d = parseInt(document.getElementById('rsaD').value);
                
                if (!isPrime(p) || !isPrime(q)) {
                    document.getElementById('rsaResult').value = "p e q devem ser números primos!";
                    return;
                }
                
                const n = p * q;
                const encrypted = encryptedText.split(' ').map(Number);
                
                const decrypted = rsaDecrypt(encrypted, d, n);
                document.getElementById('rsaResult').value = decrypted;
            });

            // Função para calcular exponenciação modular eficientemente
            function modExp(base, exp, modulus) {
                let result = 1;
                base = base % modulus;
                while (exp > 0) {
                    if (exp % 2 === 1) {
                        result = (result * base) % modulus;
                    }
                    exp = Math.floor(exp / 2);
                    base = (base * base) % modulus;
                }
                return result;
            }

            // Função para verificar se um número é primo
            function isPrime(num) {
                if (num <= 1) return false;
                if (num <= 3) return true;
                if (num % 2 === 0 || num % 3 === 0) return false;
                for (let i = 5; i * i <= num; i += 6) {
                    if (num % i === 0 || num % (i + 2) === 0) return false;
                }
                return true;
            }

            // Função para calcular MDC (Maior Divisor Comum)
            function gcd(a, b) {
                while (b !== 0) {
                    let temp = b;
                    b = a % b;
                    a = temp;
                }
                return a;
            }

            // Função para criptografar com RSA
            function rsaEncrypt(message, e, n) {
                return message.split('').map(char => {
                    const m = char.charCodeAt(0);
                    return modExp(m, e, n);
                });
            }

            // Função para descriptografar com RSA
            function rsaDecrypt(encrypted, d, n) {
                return encrypted.map(c => {
                    const m = modExp(c, d, n);
                    return String.fromCharCode(m);
                }).join('');
            }
        </script>

        <script src="js/scripts.js"></script>
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    </body>
</html>